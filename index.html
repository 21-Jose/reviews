<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>¬øQu√© opina la gente de Jos√©?</title>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      background: #f5f5f5;
    }
    h1 {
      text-align: center;
      padding: 1rem;
      background-color: #ffffff;
      margin: 0;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .controls {
      padding: 1rem;
      background: #fff;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      align-items: center;
      justify-content: center;
    }
    .controls input,
    .controls select,
    .controls button {
      padding: 0.5rem;
      font-size: 1rem;
      flex: 1 1 200px;
      min-width: 150px;
    }
    .container {
      max-width: 600px;
      margin: 1rem auto;
      padding: 0 1rem;
    }
    .comment {
      background: white;
      border-radius: 8px;
      padding: 1rem;
      margin-bottom: 1rem;
      box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
      opacity: 0;
      transform: translateY(10px);
      transition: opacity 0.8s ease, transform 0.8s ease;
      position: relative;
    }
    .comment.show {
      opacity: 1;
      transform: translateY(0);
    }
    .stars {
      color: gold;
      font-size: 1.2rem;
      margin-bottom: 0.5rem;
    }
    .username {
      font-weight: bold;
      margin-bottom: 0.25rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }
    .username.hidden-name .name-text {
      display: none;
    }
    .username.visible-name .reveal-name-btn {
      display: none;
    }
    .reveal-name-btn {
      background: transparent;
      border: none;
      font-size: 1.1rem;
      cursor: pointer;
      padding: 0;
    }
    .text {
      color: #333;
    }
    .name-text{
      font-size: 1.1rem;
    }
    .translate-btn {
      margin-top: 0.5rem;
      font-size: 0.9rem;
      padding: 0.3rem 0.5rem;
      background: #e0e0e0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .translate-btn:hover {
      background: #d0d0d0;
    }
    .translated-text {
      display: none;
      margin-top: 0.5rem;
      color: #555;
      opacity: 0;
      transition: opacity 0.4s ease;
    }
    .translated-text.show {
      display: block;
      opacity: 1;
    }
    .hidden {
      display: none !important;
    }

    .barney-img {
      display: block;
      margin-top: 1rem;
      height: 100px;
      border-radius: 8px;
      opacity: 0;
      transform: scale(0.8);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .barney-img.show {
      opacity: 1;
      transform: scale(1);
    }

    /*
* {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    */
    .banner {
      display: flex;
      align-items: center;
      justify-content: space-between;
      background: linear-gradient(90deg, #ffef00, #00bfff);
      color: #000;
      padding: 1rem;
      border-radius: 12px;
      font-family: 'Arial Black', sans-serif;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
      flex-wrap: wrap;
    }

    .banner-text {
      flex: 1;
      min-width: 250px;
    }

    .banner-text h3 {
      font-size: 1.8rem;
      margin-bottom: 0.5rem;
    }

    .banner-text p {
      font-size: 1.1rem;
    }

    .banner-img {
      max-width: 180px;
      flex-shrink: 0;
      margin-left: 1rem;
    }

    .banner-img img {
      width: 100%;
      height: auto;
      border-radius: 10px;
    }

    @media (max-width: 600px) {
      .banner {
        flex-direction: column-reverse;
        text-align: center;
      }

      .banner-img {
        margin: 1rem auto 0;
      }
    }
  </style>
</head>
<body>

  <h1>¬øQu√© opina la gente de Jos√©?</h1>

  <div class="controls">
    <input id="search-input" type="text" placeholder="Buscar comentarios..." />
    <select id="sort-select">
      <option value="original">Orden original</option>
      <option value="desc">Ordenar por valoraci√≥n: alta ‚Üí baja</option>
      <option value="asc">Ordenar por valoraci√≥n: baja ‚Üí alta</option>
    </select>
    <button id="toggle-names-btn">Mostrar nombres de usuarios</button>
  </div>

  <div class="container" id="comments-container"></div>


  <div class="banner">
    <div class="banner-text">
      <h3>‚ö†Ô∏è ¬°¬°√öltimos d√≠as!! <br>Pizzas a domicilio tra√≠das por este t√≠o </h3>
      <p>üçï ¬øTu pizza llega fr√≠a? ¬∑ Me la pela, dame mi propina üí∏</p>
    </div>
    <div class="banner-img">
      <img src="Jdomi.png" alt="Jos√© disfrazado promocionando pizzas" />
    </div>
  </div>
  

  <script>
    const allComments = [
      { user: "Carlos", rating: 3, text: "muy guapo el pelo pero no me liar√≠a." },
      { user: "Killer", rating: 5, text: "Es un t√≠o de puta madre: sincero, amable, trabajador, buena persona. Lo √∫nico es que es un poco dormil√≥n y se cabrea demasiado cuando pierde y se vuelve un poco bully, pero por lo dem√°s 10/10." },
      { user: "Sergio", rating: 4, text: "No era lo que esperaba, pero tampoco s√© qu√© esperaba. Lleg√≥ tarde, haciendo ruido y sin instrucciones. Dice ser ‚Äúedici√≥n limitada‚Äù, pero habla como si lo fabricaran en masa. Compatible con snacks y videojuegos, pero incompatible con madrugar. <br><br>No lo devolver√© solo porque ya me encari√±√©, pero tampoco lo recomendar√≠a a alguien que valore su paz mental." },
      { user: "Zocky", rating: 5, text: "Buen amiguito, lo que m√°s me gusta es cuando viene a casa y nos rasca la barriguita y nos dice cositas a Toby y a mi ;)" },
      { user: "Mar√≠a", rating: 5, text: "Producto de puta madre, risas 100% aseguradas. Si eres fan√°tico de marvel aciertas seguro.<br><br>No te asustes, puede zamparse un bocadillo, unos filipinos y una bolsa de patatas en 20 minutos, pero la manzana nunca puede faltar. No te preocupes si le pierdes, se le distingue de lejos.<br><br>Nivel de competitividad alto (en el beisbol nos funde a todos, eso si, con el Mario Party le puedes fundir t√∫ a √©l)." },
      { user: "Barney Stinson", rating: 5, text: ["Un t√≠o legen...","espera...","dario."]},
      { user: "Polo", rating: 5, text: "Un Amigo de Puta Madre.<br><br>Le conoc√≠ en clase y result√≥ ser una ganga. Desde el primer uso, ya ven√≠a soltando co√±as. No necesita manual de instrucciones: se entiende solo y funciona mejor que el WiFi de la Xbox.<br><br>Pros:<ul><li>Nivel de risas: infinito</li><li>Cae bien instant√°neamente</li> <li>Compatible con todo tipo de planes.</li></ul><br>Contras:<ul><li>A veces dice tonter√≠as que te hacen cuestionar tu salud mental de tanto re√≠r</li><li>No viene con bot√≥n de apagado (pero tampoco hace falta)</li></ul><br>Tutu, cu√≠dalo bien que ya no fabrican muchos como este. Limited edition 10/10." },
  {
        user: "Phil Spencer",
        rating: 5,
        text: "Hope you all enjoyed our latest Xbox Showcase ‚Äî it means a lot to see the incredible energy from the community every year. Your passion, feedback, and support continue to inspire the entire team. Thanks for being on this journey with us. We‚Äôre just getting started.",
        translated: "Mondongo"
      },
      { user: "Rolo", rating: 6, text: "Aunque el no lo sepa, le admiro mucho. No cualquiera saca energ√≠as para seguir adelante mientras estudia, trabaja y siempre que puede saca tiempo para estar con su novia y sus amigos.<br><br>Desde que le conozco siempre ha hecho todo lo posible para salir adelante. Este es uno de los infinitos motivos por los que estoy orgulloso de la persona en la que se ha convertido. Digo convertido porque he conseguido ver su evoluci√≥n como persona desde cerca. Ha aprendido de sus errores desde muy peque√±o y esto le ha permitido ser la gran persona que es a d√≠a de hoy.<br><br>Digo esto porque a pesar de que no me lo digas, se que te arrepientes de como te comportaste conmigo cuando √©ramos ni√±os. As√≠ que aprovecho para decirte lo siguiente:<br>Yo ya te he perdonado desde hace mucho tiempo, desde el momento que me pediste perd√≥n en la casa del pueblo de Carlos. De hecho no solo te he perdonado. Considero que a pesar de que no tengamos la misma sangre, te has convertido en un hermano para mi. Siempre me apoyas incondicionalmente con mis pasiones y sue√±os. Cosa que muchas personas en las que confio no hacen‚Ä¶ Valoro mucho tu opini√≥n porque se que siempre vas a decir la verdad para que mejore como persona y no porque sea lo que quiero escuchar.<br><br>Siento haberte dado esta charla, pero he pensado que era el momento perfecto para recordarte que eres un amigo inigualable, una gran persona y un hermano para mi. Mi casa es tu casa, si lo necesitas mis puertas est√°n abiertas. Y quiero que se te grabe en cabeza." },
      { user: "Iv√°n", rating: 5, text: "Muy buena calidad 100% recomendable." },
      { user: "El rayo maqueen", rating: 5, text: "¬°Ka-chow!" },
      { user: "Elsa", rating: 5, text: "Gran hermano, mejor compa√±ero.<br><br>Noble es su apellido, ah pero no le pidas dinero que capaz se tira record√°ndote lo que le debes un a√±o entero hasta que se lo devuelves. Mama no ha podido darme mejor regalo en esta vida que compartirla con el, siempre ha sido mi gran apoyo sobretodo en los momentos m√°s complicados que nos ha tocado vivir. Le admiro por lo que hace por su familia y amigos, tambi√©n por todo lo que ha conseguido poco a poco. Como hermana ahi estar√© yo para verle conseguir todo lo que se propone y sobretodo levantarle cuando se caiga y animarle a seguir hacia adelante, porque si una cosa tengo clara en esta vida es que nunca dejar√© que se hunda (ni el ni nadie en mi familia)<br><br>Uno de mis mi mejores recuerdos siempre ser√° de peque√±itos jugando con las olas del mar (odiaba ir a la playa pero siempre consegu√≠a que me lo pasara bien)" },
      { user: "Miguel", rating: 1, text: "No lo recomiendo para nada." },
      { user: "Esteban", rating: 5, text: "Fant√°stico desde el principio." },
      { user: "Natalia", rating: 4, text: "Buena experiencia en general." },
      { user: "Iv√°n", rating: 3, text: "Est√° bien, sin m√°s." },
      { user: "Andrea", rating: 2, text: "Demasiado lento el servicio." },
      { user: "Tom√°s", rating: 1, text: "No volver√© a usarlo." },
      
    ];

    let filteredComments = [];

    function renderStars(rating, isRayo = false) {
      const baseSymbol = isRayo ? '‚ö°' : '‚òÖ';
      const emptySymbol = isRayo ? '‚ö°' : '‚òÜ';
    
      if (rating === 6) {
        return baseSymbol.repeat(5) + '<span title="Estrella extra especial" style="font-size: 1rem;">‚ú®</span>';
      } else {
        return baseSymbol.repeat(rating) + emptySymbol.repeat(5 - rating);
      }
    }

    function renderCommentsWithFadeIn() {
      const container = document.getElementById('comments-container');
      container.innerHTML = '';
      filteredComments.forEach((comment, index) => {
        const { user, rating, text, translated } = comment;
        const isRayo = user.toLowerCase().includes("rayo");
        const isBarneyStyle = Array.isArray(text); // Detectar si es tipo Barney (varias strings)
    
        const div = document.createElement('div');
        div.className = 'comment';
        div.style.transitionDelay = `${index * 150}ms`;
    
        let textHtml = '';
    
        if (isBarneyStyle) {
          textHtml = `
            <span class="barney-part" data-step="0">${text[0]}</span>
            <button class="barney-btn" data-next="1">Mostrar m√°s</button>
          `;
        } else {
          textHtml = `<div class="text">${text}</div>`;
        }
    
        div.innerHTML = `
          <div class="stars">${renderStars(rating, isRayo)}</div>
          <div class="username hidden-name">
            <button class="reveal-name-btn" title="Mostrar nombre">‚ùî‚ùî‚ùî</button>
            <span class="name-text">${user}</span>
          </div>
          <div class="text">${textHtml}</div>
          ${translated ? `
            <button class="translate-btn">Mostrar traducci√≥n</button>
            <div class="translated-text">${translated}</div>
          ` : ''}
        `;
        container.appendChild(div);
        requestAnimationFrame(() => {
          div.classList.add('show');
        });
      });
    }
    function applyFilters() {
      const search = document.getElementById('search-input').value.toLowerCase();
      const sort = document.getElementById('sort-select').value;
      
      // CHACHO APLICAME ESTO
      filteredComments = allComments
        .filter(c => {
            const text = typeof c.text === 'string'
              ? c.text
              : (Array.isArray(c.text?.parts) ? c.text.parts.join(' ') : '');
            return text.toLowerCase().includes(search);
          });

      if (sort === 'asc') {
        filteredComments.sort((a, b) => a.rating - b.rating);
      } else if (sort === 'desc') {
        filteredComments.sort((a, b) => b.rating - a.rating);
      }
      // 'original' no sort

      renderCommentsWithFadeIn();
    }

    document.addEventListener('DOMContentLoaded', () => {
      applyFilters();

      document.getElementById('search-input').addEventListener('input', applyFilters);
      document.getElementById('sort-select').addEventListener('change', applyFilters);

      const toggleNamesBtn = document.getElementById('toggle-names-btn');
      let namesVisible = false;

      toggleNamesBtn.addEventListener('click', () => {
        const usernames = document.querySelectorAll('.username');
        usernames.forEach(u => {
          u.classList.toggle('visible-name', !namesVisible);
          u.classList.toggle('hidden-name', namesVisible);
        });
        namesVisible = !namesVisible;
        toggleNamesBtn.textContent = namesVisible
          ? "Ocultar nombres de usuarios"
          : "Mostrar nombres de usuarios";
      });

      const container = document.getElementById('comments-container');
      container.addEventListener('click', (e) => {
        if (e.target.classList.contains("translate-btn")) {
          e.stopPropagation();
          const btn = e.target;
          const txt = btn.nextElementSibling;
          const isVisible = txt.classList.contains('show');
          txt.classList.toggle('show');
          btn.textContent = isVisible ? "Mostrar traducci√≥n" : "Ocultar traducci√≥n";
        }

        if (e.target.classList.contains("reveal-name-btn")) {
          e.stopPropagation();
          const comment = e.target.closest('.comment');
          const nameEl = comment.querySelector(".username");
          nameEl.classList.remove('hidden-name');
          nameEl.classList.add('visible-name');
        }
        if (e.target.classList.contains("barney-btn")) {
          e.stopPropagation();
          const btn = e.target;
          const nextStep = parseInt(btn.dataset.next, 10);
          const commentEl = btn.closest('.comment');
          const span = commentEl.querySelector('.barney-part');
          const index = Array.from(document.getElementById('comments-container').children).indexOf(commentEl);
          const parts = allComments[index].text;
        
          span.textContent += " " + parts[nextStep];
          
          if (nextStep + 1 < parts.length) {
            btn.dataset.next = nextStep + 1;
          } else {
            btn.remove(); // √öltima parte mostrada, se quita el bot√≥n
          
            // A√±adir imagen con animaci√≥n
            const img = document.createElement("img");
            img.src = "https://images-wixmp-ed30a86b8c4ca887773594c2.wixmp.com/f/ad6e5b81-f039-42fa-a02a-23688d84f2bc/dfcwi6u-a2775cfc-6e2e-4635-a9ad-7a38fc649ed3.png?token=eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1cm46YXBwOjdlMGQxODg5ODIyNjQzNzNhNWYwZDQxNWVhMGQyNmUwIiwiaXNzIjoidXJuOmFwcDo3ZTBkMTg4OTgyMjY0MzczYTVmMGQ0MTVlYTBkMjZlMCIsIm9iaiI6W1t7InBhdGgiOiJcL2ZcL2FkNmU1YjgxLWYwMzktNDJmYS1hMDJhLTIzNjg4ZDg0ZjJiY1wvZGZjd2k2dS1hMjc3NWNmYy02ZTJlLTQ2MzUtYTlhZC03YTM4ZmM2NDllZDMucG5nIn1dXSwiYXVkIjpbInVybjpzZXJ2aWNlOmZpbGUuZG93bmxvYWQiXX0.xSyWGnfDIhiGagJ0077xoAg3ZGlMppRqYQO9t3BOvdA";
            img.alt = "Barney Stinson";
            img.className = "barney-img";
            commentEl.appendChild(img);
            
            // Forzar la animaci√≥n despu√©s de a√±adirla
            requestAnimationFrame(() => {
              img.classList.add("show");
            });
          }
        }
      });
    });
  </script>
</body>
</html>
